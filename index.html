<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chat app</title>
  <link rel="stylesheet" href="styles/main.css">
  <!-- !DO NOT EDIT! autogenerated includes by grunt-bower-install, see Gruntfile.js -->
  <!-- bower:js -->
  <script src="bower_components/jquery/dist/jquery.js"></script>
  <script src="bower_components/angular/angular.js"></script>
  <script src="bower_components/angular-route/angular-route.js"></script>
  <script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
  <script src="bower_components/bootstrap-sass/assets/javascripts/bootstrap.js"></script>
  <script src="bower_components/angular-animate/angular-animate.js"></script>
  <script src="bower_components/angular-websocket/angular-websocket.min.js"></script>
  <script src="bower_components/angular-resource/angular-resource.js"></script>
  <!-- endbower -->

  <!-- !DO NOT EDIT! autogenerated includes by grunt-include-source, see Gruntfile.js -->
  <!-- include: "type": "js", "files": "app/**/*.js" -->
  <script src="app/app.js"></script>
  <script src="app/chat/chatController.js"></script>
  <script src="app/chat/chatService.js"></script>
  <script src="app/chatHistory/chatHistoryService.js"></script>
  <!-- /include -->

</head>
<body ng-app="Chat">

  <div class="container" ng-controller="chatController as chatCtrl">
    <!-- User session : login/out-->
    <div class="row">
        <form class="form-inline" ng-submit="joinChat()" name="userForm">
          <div class="form-group">
            <input id="usernameInput" type="text" class="form-control" placeholder="Your name..." ng-model="chatCtrl.username">
          </div>
          <button class="btn btn-primary" id="btnJoin" type="submit">Join Chat</button>
          <!-- Name chack : too long or duplicate name -->
          <span class="alert"></span>
        </form>
    </div>

    <!-- Chat container -->
    <div class="row">
      <div class="chat-room" ng-model="messages">
        <ul>
          <li ng-repeat="message in messages">Message from "{{message.origin}}" says: {{message.content}} </li>
        </ul>
      </div>
    </div>

    <!-- Ínput sessopm -->
    <div class="row">
      <form ng-submit="sendMessage()" class="form-inline">
        <div class="form-group">
          <input id="messageInput" type="text" class="form-control" placeholder="Input message..." ng-model="chatCtrl.message">
        </div>
        <button class="btn btn-primary" type="submit"><span class="glyphicon glyphicon-send"></span> Send</button>
      </form>
    </div>

    <div class="row">
      <button class="btn btn-primary" ng-click="getAllUsers()">Get All users</button>
      <ul>
        <li ng-repeat = "user in chatCtrl.allUsers.data">
          {{user.nick}}: {{user.online}}
        </li>
      </ul>
    </div>

    <div class="row">
      <button class="btn btn-primary" ng-click="getAllHistory()">Get history</button>
      <select name="userSelect" id="userSelect" ng-model="selectedUser" ng-options="user.nick for user in chatCtrl.allUsers.data">Select user</select>
      <table id="history">
        <tr>
          <th>Time</th>
          <th>Sender</th>
          <th>Message</th>
        </tr>
        <tr data-ng-repeat = "item in chatCtrl.history.data | filter:excludeServerMessage | filter: selectedUser.nick">
          <td>{{item.timestamp | date:'yyyy-MM-dd HH:mm:ss'}} </td>
          <td>{{item.from}}</td>
          <td>{{item.msg}}</td>
        </tr>
      </table>
    </div>
  </div>
  
  </div>
  
</body>
</html>